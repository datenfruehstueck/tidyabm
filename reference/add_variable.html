<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="A variable is expected to updated at various (if not all) iterations. It
gets initiated at the start with the status quo of the model and is
accessible throughout runtime. Compared to a characteristic, it thus
requires runtime resources but is flexibly updated at every iteration."><title>Add a flexible variable — add_variable • tidyabm</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add a flexible variable — add_variable"><meta property="og:description" content="A variable is expected to updated at various (if not all) iterations. It
gets initiated at the start with the status quo of the model and is
accessible throughout runtime. Compared to a characteristic, it thus
requires runtime resources but is flexibly updated at every iteration."><meta property="og:image" content="https://datenfruehstueck.github.io/tidyabm/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tidyabm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/boundedconfidence.html">Deffuant et al.'s Bounded Confidence Model of Opinion Dynamics</a>
    <a class="dropdown-item" href="../articles/diffusion.html">Rogers' Diffusion</a>
    <a class="dropdown-item" href="../articles/segregation.html">Schelling's Segregation</a>
    <a class="dropdown-item" href="../articles/voter.html">Holley and Liggett's Voter Model</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/datenfruehstueck/tidyabm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Add a flexible variable</h1>
      <small class="dont-index">Source: <a href="https://github.com/datenfruehstueck/tidyabm/blob/HEAD/R/tidyabm_class.R" class="external-link"><code>R/tidyabm_class.R</code></a></small>
      <div class="d-none name"><code>add_variable.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A variable is expected to updated at various (if not all) iterations. It
gets initiated at the start with the status quo of the model and is
accessible throughout runtime. Compared to a characteristic, it thus
requires runtime resources but is flexibly updated at every iteration.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">add_variable</span><span class="op">(</span><span class="va">.tidyabm</span>, <span class="va">...</span>, .overwrite <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for tidyabm</span></span>
<span><span class="fu">add_variable</span><span class="op">(</span><span class="va">.tidyabm</span>, <span class="va">...</span>, .overwrite <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>.tidyabm</dt>
<dd><p>a <code>tidyabm</code> object</p></dd>


<dt>...</dt>
<dd><p>&lt;<code><a href="https://rlang.r-lib.org/reference/args_data_masking.html" class="external-link">data-masking</a></code>&gt; Name-value pairs.
The name gives the name of the variable. To avoid misunderstandings use
unique variable names, also between agents and environments. Try to also
avoid starting your name with a point/dot (<code>.</code>) because some internally
added names use that pattern. Good variable names also do not have any
whitespace and are all lowercase; use underscores to separate any words.
It is recommended to also avoid the use of minus signs. Hence, a good
variable name looks like <code>this_is_a_great_name</code>.
The value has to be one of:</p><ul><li><p>a single value (e.g., a character, numeric, logical, vector ...)</p></li>
<li><p>a function to be run at every iteration of the modelling process</p></li>
</ul><p>Keep in mind that for single values that are not expected to change,
<a href="set_characteristic.html">set_characteristic</a> is a better-fitting method as it is not re-run at
every iteration of the modelling process.</p>
<p>For functions you may use a function which gets called at every iteration
with two arguments, <code>me</code> (which is the <code>tidyabm</code> object at that specific
point in time) and <code>abm</code> (which is the whole <code>tidyabm</code> object). Note that
for <code>tidyabm_env</code> objects these two arguments are the same but for
<code>tidyabm_agent</code> objects they are different in that the first (<code>me</code>) is
the current agent and the second (<code>abm</code>) is the whole environment model.
If you write your own functions or need to provide additional arguments to
functions, use the style of anonymized functions directly in-line (through
<code>function(me, abm) ...</code> or <code>\(me, abm) ...</code>).</p></dd>


<dt>.overwrite</dt>
<dd><p>if <code>FALSE</code> (the default), variables with the same name
will not be overwritten (a warning will be issued)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a <code>tidyabm</code> object</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="create_agent.html">create_agent</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="set_characteristic.html">set_characteristic</a></span><span class="op">(</span>age <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">add_variable</span><span class="op">(</span>share_same_age <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">me</span>, <span class="va">abm</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>                <span class="va">neighbors</span> <span class="op">&lt;-</span> <span class="fu">get_neighbors</span><span class="op">(</span><span class="va">me</span><span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">neighbors</span><span class="op">$</span><span class="va">age</span> <span class="op">==</span> <span class="va">me</span><span class="op">$</span><span class="va">age</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">neighbors</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>              <span class="op">}</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">add_variable</span><span class="op">(</span>feels_welcome <span class="op">=</span> \<span class="op">(</span><span class="va">me</span>, <span class="va">abm</span><span class="op">)</span> <span class="va">share_same_age</span> <span class="op">&gt;=</span> <span class="fl">.50</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 1 × 1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     age</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ABM agent</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">* 1 agent characteristic(s), </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">* 2 agent variable(s), </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">* 0 agent rule(s), </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="create_grid_environment.html">create_grid_environment</a></span><span class="op">(</span>seed <span class="op">=</span> <span class="fl">9896</span>, size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">add_variable</span><span class="op">(</span>m_age <span class="op">=</span> \<span class="op">(</span><span class="va">me</span>, <span class="va">abm</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="convert_agents_to_tibble.html">convert_agents_to_tibble</a></span><span class="op">(</span><span class="va">me</span><span class="op">)</span><span class="op">$</span><span class="va">age</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 0 × 0</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ABM grid environment</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">* 5x5, 0 agents</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">* 0 environment characteristic(s), </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">* 1 environment variable(s), </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">* 0 environment rule(s), </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">* not initiated</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Mario Haim.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

